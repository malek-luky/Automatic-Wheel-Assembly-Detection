
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="DTU">
      
      
      
      
        <link rel="next" href="improvements/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.4">
    
    
      
        <title>Wheel_Assembly_Detection</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.50c56a3b.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#car-wheel-assembly-detection" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Wheel_Assembly_Detection" class="md-header__button md-logo" aria-label="Wheel_Assembly_Detection" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Wheel_Assembly_Detection
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Home
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Wheel_Assembly_Detection" class="md-nav__button md-logo" aria-label="Wheel_Assembly_Detection" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Wheel_Assembly_Detection
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Home
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tech-stack-tools" class="md-nav__link">
    <span class="md-ellipsis">
      ‚öôÔ∏è Tech Stack &amp; Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project" class="md-nav__link">
    <span class="md-ellipsis">
      üìù Project
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìù Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    <span class="md-ellipsis">
      Motivation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    <span class="md-ellipsis">
      Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-goal" class="md-nav__link">
    <span class="md-ellipsis">
      Project Goal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approach" class="md-nav__link">
    <span class="md-ellipsis">
      Approach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methodology" class="md-nav__link">
    <span class="md-ellipsis">
      Methodology
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Limitations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#framework" class="md-nav__link">
    <span class="md-ellipsis">
      Framework
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conda-installation" class="md-nav__link">
    <span class="md-ellipsis">
      üêç Conda Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üêç Conda Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-environment-install-the-dependencies-and-download-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Create the environment, install the dependencies and download the data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      üê≥ Docker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üê≥ Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-the-container-locally-after-downloading-the-repository" class="md-nav__link">
    <span class="md-ellipsis">
      Build the container locally after downloading the repository.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pulls-the-docker-image-from-gcp-artifact-registry" class="md-nav__link">
    <span class="md-ellipsis">
      Pulls the docker image from GCP Artifact Registry
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#google-cloud-computing" class="md-nav__link">
    <span class="md-ellipsis">
      üíª Google Cloud Computing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üíª Google Cloud Computing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-vm-machine-in-gcp" class="md-nav__link">
    <span class="md-ellipsis">
      Create VM Machine in GCP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#via-gcloud-command" class="md-nav__link">
    <span class="md-ellipsis">
      Via gcloud command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connecting-to-vm-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Connecting to VM machine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controlling-deployed-virtual-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Controlling deployed Virtual Machine
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional" class="md-nav__link">
    <span class="md-ellipsis">
      üëÄ Optional
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üëÄ Optional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#re-process-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Re-process the data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#re-train-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Re-train the model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-training-locally-without-wb" class="md-nav__link">
    <span class="md-ellipsis">
      Run training locally without W&amp;B
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-training-locally-with-wb" class="md-nav__link">
    <span class="md-ellipsis">
      Run training locally with W&amp;B
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-the-conda-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Remove the conda environment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment" class="md-nav__link">
    <span class="md-ellipsis">
      üåê Deployment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üåê Deployment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Workflows
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-our-model" class="md-nav__link">
    <span class="md-ellipsis">
      ü§ñ Use our model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ü§ñ Use our model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cloud-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Cloud Deployment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Local deployment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    <span class="md-ellipsis">
      ü§ù Contributing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technology-used" class="md-nav__link">
    <span class="md-ellipsis">
      üíª Technology Used
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagram" class="md-nav__link">
    <span class="md-ellipsis">
      DIAGRAM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-structure" class="md-nav__link">
    <span class="md-ellipsis">
      üìÇ PROJECT STRUCTURE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acknowledgements" class="md-nav__link">
    <span class="md-ellipsis">
      üôè Acknowledgements
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="improvements/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Improvements
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List of Commands
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="docker/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker Notes
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="summary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Project Summary
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="todo/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Slack Canva
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#tech-stack-tools" class="md-nav__link">
    <span class="md-ellipsis">
      ‚öôÔ∏è Tech Stack &amp; Tools
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project" class="md-nav__link">
    <span class="md-ellipsis">
      üìù Project
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üìù Project">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#motivation" class="md-nav__link">
    <span class="md-ellipsis">
      Motivation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data" class="md-nav__link">
    <span class="md-ellipsis">
      Data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-goal" class="md-nav__link">
    <span class="md-ellipsis">
      Project Goal
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approach" class="md-nav__link">
    <span class="md-ellipsis">
      Approach
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#methodology" class="md-nav__link">
    <span class="md-ellipsis">
      Methodology
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    <span class="md-ellipsis">
      Limitations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#framework" class="md-nav__link">
    <span class="md-ellipsis">
      Framework
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conda-installation" class="md-nav__link">
    <span class="md-ellipsis">
      üêç Conda Installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üêç Conda Installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-the-environment-install-the-dependencies-and-download-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Create the environment, install the dependencies and download the data
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      üê≥ Docker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üê≥ Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#build-the-container-locally-after-downloading-the-repository" class="md-nav__link">
    <span class="md-ellipsis">
      Build the container locally after downloading the repository.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pulls-the-docker-image-from-gcp-artifact-registry" class="md-nav__link">
    <span class="md-ellipsis">
      Pulls the docker image from GCP Artifact Registry
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#google-cloud-computing" class="md-nav__link">
    <span class="md-ellipsis">
      üíª Google Cloud Computing
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üíª Google Cloud Computing">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#create-vm-machine-in-gcp" class="md-nav__link">
    <span class="md-ellipsis">
      Create VM Machine in GCP
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#via-gcloud-command" class="md-nav__link">
    <span class="md-ellipsis">
      Via gcloud command
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#connecting-to-vm-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Connecting to VM machine
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#controlling-deployed-virtual-machine" class="md-nav__link">
    <span class="md-ellipsis">
      Controlling deployed Virtual Machine
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#optional" class="md-nav__link">
    <span class="md-ellipsis">
      üëÄ Optional
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üëÄ Optional">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#re-process-the-data" class="md-nav__link">
    <span class="md-ellipsis">
      Re-process the data
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#re-train-the-model" class="md-nav__link">
    <span class="md-ellipsis">
      Re-train the model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-training-locally-without-wb" class="md-nav__link">
    <span class="md-ellipsis">
      Run training locally without W&amp;B
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#run-training-locally-with-wb" class="md-nav__link">
    <span class="md-ellipsis">
      Run training locally with W&amp;B
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#remove-the-conda-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Remove the conda environment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment" class="md-nav__link">
    <span class="md-ellipsis">
      üåê Deployment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="üåê Deployment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#automatic-workflows" class="md-nav__link">
    <span class="md-ellipsis">
      Automatic Workflows
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-our-model" class="md-nav__link">
    <span class="md-ellipsis">
      ü§ñ Use our model
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ü§ñ Use our model">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#cloud-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Cloud Deployment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#local-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Local deployment
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#contributing" class="md-nav__link">
    <span class="md-ellipsis">
      ü§ù Contributing
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technology-used" class="md-nav__link">
    <span class="md-ellipsis">
      üíª Technology Used
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#diagram" class="md-nav__link">
    <span class="md-ellipsis">
      DIAGRAM
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-structure" class="md-nav__link">
    <span class="md-ellipsis">
      üìÇ PROJECT STRUCTURE
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acknowledgements" class="md-nav__link">
    <span class="md-ellipsis">
      üôè Acknowledgements
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="car-wheel-assembly-detection">Car Wheel Assembly Detection üöò</h1>
<p><img alt="GitHub last commit (branch)" src="https://img.shields.io/github/last-commit/malek-luky/Automatic-Wheel-Assembly-Detection/main?style=flat" />
<img alt="GitHub Actions Workflow Status" src="https://img.shields.io/github/actions/workflow/status/malek-luky/Automatic-Wheel-Assembly-Detection/.github%2Fworkflows%2Fbuild_conda.yml?branch=main&amp;label=Project%20Image" />
<img alt="Website" src="https://img.shields.io/website?url=https%3A%2F%2Fdeployed-model-service-t2tcujqlqq-ew.a.run.app%2Fdocs&amp;up_message=online&amp;down_message=offline&amp;style=flat&amp;label=model" /></p>
<p><strong>Authors</strong>: Elizaveta Isianova, Lukas Malek, Lukas Rasocha, Vratislav Besta, Weihang Li</p>
<h2 id="tech-stack-tools">‚öôÔ∏è Tech Stack &amp; Tools</h2>
<p><img alt="GitHub top language" src="https://img.shields.io/github/languages/top/malek-luky/Automatic-Wheel-Assembly-Detection?style=for-the-badge&amp;logo=python" />
<img alt="Conda" src="https://img.shields.io/badge/conda-342B029.svg?&amp;style=for-the-badge&amp;logo=anaconda&amp;logoColor=white" />
<img alt="Gcloud" src="https://img.shields.io/badge/Google_Cloud-4285F4?style=for-the-badge&amp;logo=google-cloud&amp;logoColor=white" />
<img alt="Docker" src="https://img.shields.io/badge/docker-%230db7ed.svg?style=for-the-badge&amp;logo=docker&amp;logoColor=white" />
<img alt="PyTorch" src="https://img.shields.io/badge/PyTorch-%23EE4C2C.svg?style=for-the-badge&amp;logo=PyTorch&amp;logoColor=white" />
<img alt="DVC" src="https://img.shields.io/badge/DVC-945DD6?style=for-the-badge&amp;logo=dvc&amp;logoColor=white" />
<img alt="FastAPI" src="https://img.shields.io/badge/fastapi-109989?style=for-the-badge&amp;logo=FASTAPI&amp;logoColor=white" />
<img alt="wandb" src="https://img.shields.io/badge/Weights_&amp;_Biases-FFBE00?style=for-the-badge&amp;logo=WeightsAndBiases&amp;logoColor=white" />
<img alt="lightning" src="https://img.shields.io/badge/Lightning-792DE4?style=for-the-badge&amp;logo=lightning&amp;logoColor=white" /></p>
<h2 id="project">üìù Project</h2>
<p>This project presents an attempt to find a solution for predicting the successful assembly of tires onto wheels autonomously. Currently, the method uses purely an image based classification to predict whether the tire was assembled correctly. To enrich this, we attempt to use an LSTM model to analyze inputs from torque and force sensors of the assembling robot, enabling the system to determine the optimal conditions for tire assembly without human intervention. The goal is to increase efficiency and accuracy in tire assembly processes, reducing the reliance on manual labor and minimizing errors.</p>
<h3 id="motivation">Motivation</h3>
<p>The project is based on real case situated within the Testbed for Industry 4.0 at CTU Prague. The current quality control methodology uses CNNs for the visual inspection of tire assemblies.</p>
<h3 id="data">Data</h3>
<p>Data are meassured and labelled by the lab. The dataset is generated through robotic cell runs, every sample is then labeled as <em>true</em> (successful assembly) or <em>false</em> (unsuccessful assembly).</p>
<h3 id="project-goal">Project Goal</h3>
<p>This project aims to introduce a new method for enhancing the quality control process in car wheel assembly executed by a delta robot.</p>
<h3 id="approach">Approach</h3>
<p>Departing from the picture-based assessment using CNNs, our approach aims to evaluate the correctness of the assembly based on the data from a force-torque sensor. This transforms the dataset into a collection of time series, capturing recorded sensor data from individual tire assemblies. Each element from the series is a 6D vector combining a 3 DOF force vector and a 3 DOF torque vector.</p>
<h3 id="methodology">Methodology</h3>
<p>The chosen methodology is an implementation of Long Short-Term Memory Recurrent Neural Networks (LSTM RNNs) using PyTorch since the data are in timeseries. There is no existing baseline solution for the current problem. Therefore the project could be evaluated and compared to the existing CNN approach.</p>
<h3 id="limitations">Limitations</h3>
<p>Due to the small dataset limited by the time constraints and the amount of labelled data, we don't expect to obtain a well performing model, but rather want to present a method for further development.</p>
<h3 id="framework">Framework</h3>
<p>As a third-party framework we are going to use PyTorch Lightning and maybe with a Pytorch Forecasting package built on top of the Lightning.</p>
<h2 id="conda-installation">üêç Conda Installation</h2>
<h3 id="create-the-environment-install-the-dependencies-and-download-the-data">Create the environment, install the dependencies and download the data</h3>
<pre><code>git clone https://github.com/malek-luky/Automatic-Wheel-Assembly-Detection.git
cd Automatic-Wheel-Assembly-Detection
make conda
</code></pre>
<h2 id="docker">üê≥ Docker</h2>
<p>This will build an image of our project and run it in a container. In the container you will have all the dependencies, data and code needed to run the project. We have three different dockerfiles:
- conda_setup: debugging purposes, sets the environement and waits for user to run it in interactive mode
- train_model: downloads dependencies, trains model and send it to Weight and Biases (wandb)
- deploy_model: downloads dependencies and the model from wandb and waits for user input to make predictions</p>
<p>The following steps to build and run are written for train_model only, but it can be easily changed for any dockerfile.</p>
<h3 id="build-the-container-locally-after-downloading-the-repository">Build the container locally after downloading the repository.</h3>
<pre><code>git clone https://github.com/malek-luky/Automatic-Wheel-Assembly-Detection.git
cd Automatic-Wheel-Assembly-Detection
docker build -f dockerfiles/train_model.dockerfile . -t trainer:latest
docker run --name trainer -e WANDB_API_KEY=&lt;WANDB_API_KEY&gt; trainer:latest
</code></pre>
<h3 id="pulls-the-docker-image-from-gcp-artifact-registry">Pulls the docker image from GCP Artifact Registry</h3>
<pre><code>make docker_train_online
docker run --name trainer -e WANDB_API_KEY=&lt;WANDB_API_KEY&gt; trainer:latest
</code></pre>
<h2 id="google-cloud-computing">üíª Google Cloud Computing</h2>
<h3 id="create-vm-machine-in-gcp">Create VM Machine in GCP</h3>
<ol>
<li>Open <a href="https://console.cloud.google.com/compute/instances?project=wheel-assembly-detection">Compute Engine</a></li>
<li>Create a name</li>
<li>Region: <code>europe-west1 (Belgium)</code></li>
<li>Zone: <code>europe-west1-b</code></li>
<li>Machine configuration: <code>Compute-optimized</code></li>
<li>Series: <code>C2D</code></li>
<li>Machine Type: <code>c2d-standard-4</code> (must have at least 16GB RAM)</li>
<li>Boot disk: <code>20 GB</code></li>
<li>Container image: <code>&lt;ADDRESS-OF-IMAGE-IN-ARTIFACT-REGISTRY&gt;</code> (click Deploy Container)</li>
<li>Restart policy: <code>never</code></li>
<li>The rest is default</li>
</ol>
<h3 id="via-gcloud-command">Via gcloud command</h3>
<p>If the <code>gcloud</code> command is unkown, <a href="https://cloud.google.com/sdk/docs/install">follow the steps for your OS</a>. Otherwise there are three three dockerfiles that can be deployed to Virtual Machine in GCP. All of the create the same instance but with specific container. The instance of the name is folowing the dockerfile name (conda_setup/train_model/deploy_model)</p>
<pre><code>make conda_setup_vm
make train_model_vm
make deploy_model_vm
</code></pre>
<h3 id="connecting-to-vm-machine">Connecting to VM machine</h3>
<ul>
<li>Can be via SSH inside the browser <a href="https://console.cloud.google.com/compute/instances?project=wheel-assembly-detection">Compute Engine</a></li>
<li>Or locally using command similar to this one <code>gcloud compute ssh --zone "europe-west1-b" "&lt;name_of_instance&gt;" --project "wheel-assembly-detection"</code> (the instatnces can be listed using <code>gcloud compute instances list</code>)</li>
</ul>
<h3 id="controlling-deployed-virtual-machine">Controlling deployed Virtual Machine</h3>
<ul>
<li><code>docker ps</code>: shows the docker files running on the machine</li>
<li><code>docker logs &lt;CONATINER_ID&gt;</code> wait until its successfully pulled</li>
<li><code>docker ps</code>: pulled container has new ID</li>
<li><code>docker exec -it CONTAINER-ID /bin/bash</code>: starts the docker in interactive window (only the conda_wheel_assemly_detection, the rest only train the model, upload the model and exits, maybe setting the restart policy to "never" should fix this issue)</li>
</ul>
<h2 id="optional">üëÄ Optional</h2>
<p>It re-creates <code>filtered</code>, <code>normalized</code> and <code>processed</code> folders. The processed data is stored in <code>data/processed/dataset_concatenated.csv</code> and is used for training.</p>
<h3 id="re-process-the-data">Re-process the data</h3>
<pre><code>python src/data/make_dataset.py
</code></pre>
<h3 id="re-train-the-model">Re-train the model</h3>
<pre><code>python src/models/train_model.py
</code></pre>
<h3 id="run-training-locally-without-wb">Run training locally without W&amp;B</h3>
<pre><code>python src/models/train_model.py
</code></pre>
<h3 id="run-training-locally-with-wb">Run training locally with W&amp;B</h3>
<pre><code>python src/models/train_model.py --wandb_on
</code></pre>
<h3 id="remove-the-conda-environment">Remove the conda environment</h3>
<pre><code>conda remove --name DTU_ML_Ops --all
</code></pre>
<h2 id="deployment">üåê Deployment</h2>
<p>This repository is configured for deployment using Google CloudÔ∏è ‚òÅÔ∏è. The images in this repository are re-built and deployed automatically using GitHub Actions and stored in Google Artifact Registry on every push to the <code>main</code> branch.</p>
<p>We also automatically re-train the model using <strong>Vertex AI</strong>, store it in <strong>Weights &amp; Biases</strong> model registry and deploy it using Google Cloud Run.</p>
<h3 id="automatic-workflows">Automatic Workflows</h3>
<p>With access to GCP you can simply make your changes and merge it into main. When the merge is done, GitHub Actions will automatically train and deploy the model. We have 4 workflows in total.
- build_conda: build the image and stores in in GCP
- build_train: runs the built image on Vertex AI to train the model and sends it to wandb 
- build_deploy: deploy the image to cloud run to handle user requests and via FastAPI gives predictions</p>
<h2 id="use-our-model">ü§ñ Use our model</h2>
<h3 id="cloud-deployment">Cloud Deployment</h3>
<p>The model is deployed using Google Cloud Run. You can make a prediction using the following command:</p>
<pre><code>curl -X 'POST' \
  'https://deployed-model-service-t2tcujqlqq-ew.a.run.app/predict' \
  -H 'accept: application/json' \
  -H 'Content-Type: application/json' \
  -d '{
    &quot;sequence&quot;: [
        [0.1, 0.2, 0.3, 0.2, 0.3, 0.4, 0.2, 0.1],
        [0.2, 0.3, 0.4, 0.3, 0.4, 0.5, 0.3, 0.2],
        [0.1, 0.2, 0.3, 0.2, 0.3, 0.4, 0.2, 0.1],
        [0.1, 0.2, 0.3, 0.2, 0.3, 0.4, 0.2, 0.1],
        [0.1, 0.2, 0.3, 0.2, 0.3, 0.4, 0.2, 0.1],
        [0.1, 0.2, 0.3, 0.2, 0.3, 0.4, 0.2, 0.1],
        [0.1, 0.2, 0.3, 0.2, 0.3, 0.4, 0.2, 0.1],
        [0.1, 0.2, 0.3, 0.2, 0.3, 0.4, 0.2, 0.1],
        [0.1, 0.2, 0.3, 0.2, 0.3, 0.4, 0.2, 0.1],
        [0.2, 0.3, 0.4, 0.3, 0.4, 0.5, 0.3, 0.2]
    ]
}'
</code></pre>
<h3 id="local-deployment">Local deployment</h3>
<p>Our model can also be deployed locally. The guidelines for running a local server and making predictions are <a href="deployment/torchserve/README.md">here</a></p>
<h2 id="contributing">ü§ù Contributing</h2>
<p>Contributions are always welcome! If you have any ideas or suggestions for the project, please create an issue or submit a pull request. Please follow these <a href="https://gist.github.com/joshbuchea/6f47e86d2510bce28f8e7f42ae84c716">conventions</a> for commit messages.</p>
<h2 id="technology-used">üíª Technology Used</h2>
<ul>
<li>Docker: "PC Setup" inside the docker file</li>
<li>Conda: Package manager</li>
<li>GCP<ul>
<li>Cloud Storage: Stores data for dvc pull</li>
<li>Artifact Registry: Stores built docker images (can be created into container)</li>
<li>Compute Engine: Enables creating virtual machines</li>
<li>Functions / Run: Deployment</li>
<li>Vertex AI: includes virtual machines, training of AI models ("abstraction above VM...")</li>
</ul>
</li>
<li>OmegaConf: Handle the config data for train_model.py</li>
<li>CodeCov: Creates the coverage report and submit it as a comments to the pull request </li>
<li>CookieCutter: Template used for generating code sctructure</li>
<li>DVC: Data versioning tool, similar is github but for data</li>
<li>GitHub: Versioning tool for written code</li>
<li>GitHub Actions: Run pytest, Codecov and upload built docker images to GCP</li>
<li>Pytest: Runs some tests to check whether the code is working</li>
<li>CodeCov: Tool for uploading coverage report from pytest as a comment to pull requests</li>
<li>Weight and Biases: wandb, used for storing and tracking the trained model</li>
<li>Pytorch Lightning: Framework for training our LTSM model and storing default config values</li>
<li>Forecasting: Abstracion above Pytorch Lightning working with Timeseries data</li>
<li>Torchserve: Used for local deployment</li>
<li>FastAPI: Creates API for our model, wrap it into container so it can be accessed anywhere</li>
<li>Slack/SMS: Handle the alerts, Slack for deployed model, SMS for a server cold-run</li>
</ul>
<h2 id="diagram">DIAGRAM</h2>
<p><img alt="Diagram" src="reports/figures/diagram.png" /></p>
<h2 id="project-structure">üìÇ PROJECT STRUCTURE</h2>
<p>The directory structure of the project looks like this:</p>
<pre><code>‚îú‚îÄ‚îÄ .dvc/                 &lt;- Cache and config for data version control
‚îú‚îÄ‚îÄ .github/workflows     &lt;- Includes the steps for GitHub Actions
‚îÇ   ‚îî‚îÄ‚îÄ build_conda       &lt;- Conda dockerfile: Build conda image and push it to GCP
‚îÇ   ‚îú‚îÄ‚îÄ build_deploy      &lt;- Deploy dockerfile: build, push and deploy
‚îÇ   ‚îî‚îÄ‚îÄ build_train       &lt;- Train dockerfile: Build train image and push it to GCP
‚îÇ   ‚îî‚îÄ‚îÄ pytests           &lt;- Runs the data and model pytests
‚îú‚îÄ‚îÄ data                  &lt;- Run dvc pull to see this folder
‚îÇ   ‚îî‚îÄ‚îÄ filtered          &lt;- Seperated raw data, one file is one meassurement
‚îÇ   ‚îî‚îÄ‚îÄ normalized        &lt;- Normalized filtered data
‚îÇ   ‚îú‚îÄ‚îÄ processed         &lt;- Torch sensors from normalized data and concatenated csv
‚îÇ   ‚îî‚îÄ‚îÄ raw               &lt;- Original meassurements
‚îú‚îÄ‚îÄ deployment            &lt;- Other deployment options as Cloud Function and torchserve
‚îÇ   ‚îî‚îÄ‚îÄ cloud_functions   &lt;- File that can be run as a Cloud Function on GCP (WIP)
‚îÇ   ‚îî‚îÄ‚îÄ torchserve/       &lt;- All data needed for local deployment
‚îú‚îÄ‚îÄ dockerfiles           &lt;- Storage of out dockerfiles
‚îÇ   ‚îî‚îÄ‚îÄ conda_wheel       &lt;- Setups the machine and open interactive environement
‚îÇ   ‚îú‚îÄ‚îÄ train_wheel       &lt;- Runs train_model.py that upload the new model to wandb
‚îÇ   ‚îî‚îÄ‚îÄ serve_model       &lt;- Uses FastAPI, as the only dockerfile also deploys the model
‚îÇ   ‚îî‚îÄ‚îÄ README            &lt;- Notes and few commands regarding the dockerfiles struggle
‚îú‚îÄ‚îÄ docs                  &lt;- Documentation folder
‚îÇ   ‚îú‚îÄ‚îÄ index.md          &lt;- Homepage for your documentation
‚îÇ   ‚îú‚îÄ‚îÄ mkdocs.yml        &lt;- Configuration file for mkdocs
‚îÇ   ‚îî‚îÄ‚îÄ source/           &lt;- Source directory for documentation files
‚îú‚îÄ‚îÄ reports               &lt;- Generated analysis as HTML, PDF, LaTeX, etc.
‚îÇ   ‚îî‚îÄ‚îÄ figures/          &lt;- Generated graphics and figures to be used in reporting
‚îÇ   ‚îî‚îÄ‚îÄ README            &lt;- Exam questions and project work progress
‚îú‚îÄ‚îÄ src                   &lt;- Source code
‚îÇ   ‚îú‚îÄ‚îÄ data              &lt;- Scripts to download or generate data
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ filter        &lt;- Seperates the meassurement into csv files
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ make_dataset  &lt;- Runs filter-&gt;normalize-&gt;process as one script
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ normalize     &lt;- Normalizes the filtered data
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ process       &lt;- Changes normalized data into torch files and concatenated csv
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ README        &lt;- Includes more details about the scripts
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils         &lt;- File with custom functions
‚îÇ   ‚îú‚îÄ‚îÄ helper            &lt;- Folder with custom functions
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ convert_reqs  &lt;- Function that mirrors the requirements to environment.yml
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gcp_utils     &lt;- Function that returns wandb_api on GCP cloud via secret
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logger        &lt;- Creates logs to logs/ folder for easier debugging
‚îÇ   ‚îú‚îÄ‚îÄ models            &lt;- Model implementations, training script and prediction script
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ arch_model    &lt;- Old model class definition and function calls
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ arch_train_m  &lt;- Old model using Forecasting and TemporalFusionTransformer
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ model         &lt;- New lightweight model class definition and function calls
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ predict_model &lt;- Predicts the result from unseen data
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ train_model   &lt;- New lightweight model using Lightning's LTSM
‚îú‚îÄ‚îÄ tests                 &lt;- Contains all pytest for Github workflow
‚îÇ   ‚îî‚îÄ‚îÄ test_data         &lt;- Checks if data exist and the data shape
‚îÇ   ‚îú‚îÄ‚îÄ test_model        &lt;- Check if the trained model is correct
‚îú‚îÄ‚îÄ .gitignore            &lt;- Data that are now pushed to GitHub
‚îú‚îÄ‚îÄ .pre-commit-config    &lt;- Formats the code following pep8 and mirror requirements.txt
‚îú‚îÄ‚îÄ LICENSE               &lt;- Open-source license info
‚îú‚îÄ‚îÄ Makefile              &lt;- Makefile with convenience commands like `make data` or `make train`
‚îú‚îÄ‚îÄ README.md             &lt;- The top-level README which you are reading right now
‚îú‚îÄ‚îÄ data.dvc              &lt;- Links the newest data from GCP Cloud Storage
‚îú‚îÄ‚îÄ environment.yml       &lt;- Requirements for new conda env, also used inside docker
‚îú‚îÄ‚îÄ pyproject.toml        &lt;- Project (python) configuration file
‚îî‚îÄ‚îÄ requirements.txt      &lt;- The pip requirements file for reproducing the environment
</code></pre>
<h2 id="acknowledgements">üôè Acknowledgements</h2>
<p>Created using <a href="https://github.com/SkafteNicki/mlops_template">mlops_template</a>,
a <a href="https://github.com/cookiecutter/cookiecutter">cookiecutter template</a> for getting started with Machine Learning Operations (MLOps).</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": ["content.code.copy", "content.code.annotate"], "search": "assets/javascripts/workers/search.c011b7c0.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.7389ff0e.min.js"></script>
      
    
  </body>
</html>